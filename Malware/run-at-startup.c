#pragma comment(lib, "Advapi32.lib")

#include <windows.h>
#include <stdio.h>

int main()
{
    HKEY hkey;
    TCHAR szPath[MAX_PATH];
    DWORD dwDisposition;

    // Get the path of the executable file
    GetModuleFileName(NULL, szPath, MAX_PATH);

    // Open the registry key for startup programs
    RegCreateKeyEx(HKEY_CURRENT_USER, "Software\\Microsoft\\Windows\\CurrentVersion\\Run", 0, NULL, REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, NULL, &hkey, &dwDisposition);

    // Add the program to the startup programs list
    RegSetValueEx(hkey, "RunAtStartup", 0, REG_SZ, (BYTE*)szPath, strlen(szPath)+1);

    // Close the registry key
    RegCloseKey(hkey);

    printf("Program added to startup list.");

    return 0;
}
